@using LetterAmazer.Websites.Client.Resources.Views.Home
@model LetterAmazer.Websites.Client.ViewModels.PriceViewModel

<h1>Prices to send physical letters around the globe</h1>
<p>So, when we started LetterAmazer, we found out sending letters isn't free. But! We have done anything in our power to find the cheapest prices, so you can send letters world-wide cheaply.</p>
<p>We have a wide range of subcontractors who help us deliver letters. Depending on your requirements, we provide the cheapest prices we have.</p>
<h3>Calculate price</h3>

<b>Select country</b><br/>
@Html.DropDownListFor(model => model.SelectedItem, Model.Countries, new { @class = "form-control" })
<br/><b>How many pages?</b><br/>
<input type="number" id="getPricePageCount" value="1" class="form-control" />
<br />
<input type="button" id="getPriceBtn" value="Get price" class="btn btn-primary btn-lg" />
<br/><br/>

<label id="getPriceLbl"></label>
            




<script>
    $(document).ready(function () {
        $('#getPriceBtn').click(function () {
            updatePrice();
        });

        $('#getPricePageCount').change(function () {
            updatePrice();
        });

        $('#SelectedItem').change(function () {
            updatePrice();
        });
    });

    function updatePrice() {
        var countryId = $('#SelectedItem').val();
        var pageCount = $('#getPricePageCount').val();

        var url = '/GetPrice?countryId=' + countryId + '&pages=' + pageCount;
        $.ajax({
            type: "GET",
            url: url,
            datatype: "json",
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                $('#getPriceLbl').text(parseFloat(data).toFixed(2) + ' $ (ex. local VAT)');
            },
            error: function () {
                $('#getPriceLbl').text('No prices for this delivery');
            }
        });
    }
</script>
